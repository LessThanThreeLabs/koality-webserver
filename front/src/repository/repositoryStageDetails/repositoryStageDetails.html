<div id="repositoryStageDetails" ng-controller="RepositoryStageDetails">
	<panel>
		<panel-header>
			<span ng-show="currentChangeId != null && currentStageId == null && !showMerge">summary</span>
			<span ng-show="currentChangeId != null && currentStageInformation != null">{{currentStageInformation.name}}</span>
			<span ng-show="currentChangeId != null && currentStageId == null && showMerge">merge</span>
		</panel-header>

		<panel-body>
			<spinner id="detailsLoadingSpinner" spinner-running="spinnerOn"></spinner>

			<div id="detailsSummary" ng-show="currentChangeId != null && currentChangeInformation != null && currentStageId == null && !showSkipped && !showMerge && !showDebug">
				<styled-form text-selectable>
					<styled-form-field label="Name">{{currentChangeInformation.user.firstName}} {{currentChangeInformation.user.lastName}}</styled-form-field>
					<styled-form-field label="Email"><a href="mailto:{{currentChangeInformation.user.email}}?subject=Koality%3A%20{{repository.name}}%20-%20change%20%23{{currentChangeInformation.number}}&body=Link%20to%20change%3A%20{{currentUrl}}" target="_blank">{{currentChangeInformation.user.email}}</a></styled-form-field>
					<styled-form-field label="Submit time">{{currentChangeInformation.createTime | date:'EEEE, MM/dd hh:mm:ss a'}}</styled-form-field>
					<styled-form-field label="Branch">{{currentChangeInformation.target}}</styled-form-field>
					<styled-form-field label="Head sha">{{currentChangeInformation.headCommit.sha}}</styled-form-field>
					<styled-form-field label="Head commit"><span ng-bind-html="currentChangeInformation.headCommit.message | ascii"></span></styled-form-field>
					<styled-form-field label="Exported files" hide="{{exportUris.length == 0}}">
						<div ng-repeat="uri in exportUris"><a href="{{uri}}" target="_blank">{{uri}}</a></div>
					</styled-form-field>
				</styled-form>
			</div>

			<div id="detailsOutput" ng-show="currentChangeId != null && currentStageId != null">
				<div class="consoleTextTopBuffer"></div>
				<div class="consoleTextContainer" auto-scroll-to-bottom="lines" auto-scroll-to-bottom-buffer="40" start-at-bottom>
					<console-text class="consoleText" console-text-lines="lines"></console-text>
				</div>
				<div class="consoleTextBottomBuffer"></div>
			</div>

			<div id="detailsSkipped" ng-show="currentChangeId != null && currentChangeInformation != null && currentStageId == null && showSkipped && !showMerge && !showDebug">
				<div id="detailsSkippedMessage">
					This change was not verified because Koality is deactivated.
				</div>
				<div id="detailsSkippedInstructions">
					Contact your administrator to fix your license.
				</div>
			</div>

			<div id="detailsMerge" ng-show="currentChangeId != null && currentChangeInformation != null && currentStageId == null && !showSkipped && showMerge && !showDebug">
				<div ng-show="currentChangeInformation.mergeStatus == 'passed'">
					Change merged successfully.
				</div>
				<div ng-show="currentChangeInformation.mergeStatus == 'failed'">
					Failed to merge. Try pulling before pushing again.
				</div>
			</div>

			<div id="detailsDebug" ng-show="currentChangeId != null && currentChangeInformation != null && currentStageId == null && !showSkipped && !showMerge && showDebug">
				<div id="detailsDebugMessage">
					This change failed to create any output. This could be caused by invalid AWS credentials.
				</div>
				<div id="detailsDebugInstructions">
					Contact your administrator to correct the issue.
				</div>
			</div>
		</panel-body>
	</panel>
</div>